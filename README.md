# üìò **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ**

## **–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–≥–æ –º–∏–Ω–∏-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ HybridFlowKit (Swift Package)**

### –î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥–∏–±—Ä–∏–¥–Ω—ã—Ö iOS-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π (UIKit + SwiftUI + Flow)

---

# 1. –û–±—â–∞—è —Ü–µ–ª—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞

–°–æ–∑–¥–∞—Ç—å –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π Swift Package (`HybridFlowKit`), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥–∏–±—Ä–∏–¥–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π iOS.

–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–æ–ª–∂–µ–Ω –≤–∫–ª—é—á–∞—Ç—å:

* –µ–¥–∏–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º **Flow / –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–æ–≤**,
* —Å–∏—Å—Ç–µ–º—É **–Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã Navigator**,
* —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ **UIKit-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã**, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è SwiftUI,
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è ‚Äú—Å–∫—Ä—ã–≤–∞—é—â–µ–π—Å—è —à–∞–ø–∫–∏‚Äù (**CollapsingHeaderViewController**),
* –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π —ç–∫—Ä–∞–Ω–æ–≤ (**ScreenModule**),
* –±–∞–∑–æ–≤—ã–µ —Ç–∏–ø—ã –∏ —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è —É–¥–æ–±–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

–§—Ä–µ–π–º–≤–æ—Ä–∫ *–Ω–µ –¥–æ–ª–∂–µ–Ω* —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ª–æ–≥–∏–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–æ–ª—å–∫–æ –º–µ—Ö–∞–Ω–∏–∑–º –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ UI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

–§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–∑–∞–≤–∏—Å–∏–º**, –ª–µ–≥–∫–æ –ø–æ–¥–∫–ª—é—á–∞–µ–º—ã–π —á–µ—Ä–µ–∑ Swift Package Manager –≤ –ª—é–±–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.

---

# 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

Codex –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ —Å–ª–µ–¥—É—é—â–µ–º –≤–∏–¥–µ:

```
HybridFlowKit/
‚îú‚îÄ‚îÄ Package.swift
‚îî‚îÄ‚îÄ Sources/
    ‚îî‚îÄ‚îÄ HybridFlowKit/
        ‚îú‚îÄ‚îÄ Core/
        ‚îú‚îÄ‚îÄ Navigation/
        ‚îú‚îÄ‚îÄ Containers/
        ‚îú‚îÄ‚îÄ Integration/
        ‚îî‚îÄ‚îÄ Utils/
```

–í—Å–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –≤–Ω—É—Ç—Ä–∏:

```
Sources/HybridFlowKit/
```

---

# 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É –º–æ–¥—É–ª–µ–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞

---

## 3.1. Core ‚Äî –±–∞–∑–æ–≤—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, —è–¥—Ä–æ Flow

–ü–∞–ø–∫–∞:

```
Sources/HybridFlowKit/Core/
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

### **1. AppStateController.swift**

–°–æ–¥–µ—Ä–∂–∏—Ç:

* enum `AppState`:

  * `.splash`
  * `.onboarding`
  * `.authorized`
  * `.guest`
  * `.banned`

* –∫–ª–∞—Å—Å `AppStateController`

  * —Å–≤–æ–π—Å—Ç–≤–æ `currentState: AppState`
  * –º–µ—Ç–æ–¥ `setState(_:)`
  * –º–µ—Ç–æ–¥ `makeFlow(for state:) -> Flow`
  * —Å–≤–æ–π—Å—Ç–≤–æ `currentFlow: Flow?`
  * –º–µ—Ç–æ–¥ `currentRootViewController() -> UIViewController`
  * onFlowFinish –æ–±—Ä–∞–±–æ—Ç—á–∏–∫

### **2. Flow.swift**

–ü—Ä–æ—Ç–æ–∫–æ–ª:

```
protocol Flow: AnyObject {
    var rootViewController: UIViewController { get }
    var onFinish: ((FlowFinishEvent) -> Void)? { get set }
    func start()
}
```

### **3. FlowFinishEvent.swift**

enum:

```
enum FlowFinishEvent {
    case completed
    case cancelled
    case logout
    case switchToAuthorized
    case switchToOnboarding
    case switchToGuest
    case switchToBanned
}
```

### **4. FlowCoordinator.swift**

–ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å:

* —Ö—Ä–∞–Ω–∏—Ç `UINavigationController`
* —Ä–µ–∞–ª–∏–∑—É–µ—Ç `Flow` –±–∞–∑–æ–≤–æ
* –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã:

  * `push(_ module: ScreenModule, animated: Bool)`
  * `present(_ module: ScreenModule, animated: Bool)`
  * `pop(animated: Bool)`
  * `finish(_ event: FlowFinishEvent)`

---

# 3.2. Navigation ‚Äî –Ω–∞–≤–∏–≥–∞—Ç–æ—Ä—ã –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

–ü–∞–ø–∫–∞:

```
Sources/HybridFlowKit/Navigation/
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

### **1. Navigator.swift**

–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –±–µ–∑ –¥–µ—Ç–∞–ª–µ–π:

```
protocol Navigator: AnyObject {}
```

Codex –¥–æ–ª–∂–µ–Ω –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ.

### **2. NavigationContext.swift**

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

* —Ö—Ä–∞–Ω–∏—Ç:

  * `navigationController: UINavigationController?`
  * `tabBarController: UITabBarController?`
  * `presentingViewController: UIViewController?`

### **3. NavigationControllerProvider.swift**

–•–µ–ª–ø–µ—Ä:

* –º–µ—Ç–æ–¥ `makeNavigationController() -> UINavigationController`
* –º–µ—Ç–æ–¥ `root(_ viewController:)`

### **4. TabBarControllerProvider.swift**

–•–µ–ª–ø–µ—Ä:

* –º–µ—Ç–æ–¥ `makeTabBarController() -> UITabBarController`

---

# 3.3. Containers ‚Äî UI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

–ü–∞–ø–∫–∞:

```
Sources/HybridFlowKit/Containers/
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

### **1. BaseHostingViewController.swift**

UIViewController, –∫–æ—Ç–æ—Ä—ã–π:

* –ø—Ä–∏–Ω–∏–º–∞–µ—Ç SwiftUI View
* —Ä–∞–∑–º–µ—â–∞–µ—Ç UIHostingController –≤–Ω—É—Ç—Ä–∏
* —É–ø—Ä–∞–≤–ª—è–µ—Ç:

  * –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º child VC,
  * –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–µ–π,
  * —Å—Ç–∞—Ç—É—Å-–±–∞—Ä–æ–º
  * –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)

### **2. CollapsingHeaderViewController.swift**

–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

* headerView (UIView)
* scrollView / collectionView
* –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ progress collapse:

  * —Å–≤–æ–π—Å—Ç–≤–æ `headerCollapseProgress: CGFloat`
* –¥–µ–ª–µ–≥–∞—Ç:

  * `CollapsingHeaderDelegate`

    * `didUpdateProgress(_:)`
    * `didReachEnd()`
* –ø–æ–¥–¥–µ—Ä–∂–∫–∞ lazy load (–¥–æ—Å–∫—Ä–æ–ª–ª–∏–ª–∏ ‚Üí —Å–æ–æ–±—â–∏—Ç—å –Ω–∞—Ä—É–∂—É)

---

# 3.4. Integration ‚Äî –º–æ–¥—É–ª–∏, —Ñ–∞–±—Ä–∏–∫–∏ —ç–∫—Ä–∞–Ω–æ–≤

–ü–∞–ø–∫–∞:

```
Sources/HybridFlowKit/Integration/
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

### **1. ScreenModule.swift**

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
struct ScreenModule {
    let viewController: UIViewController
    let retainCycle: AnyObject?   // ViewModel –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
}
```

### **2. ScreenFactory.swift**

–ü—Ä–æ—Ç–æ–∫–æ–ª:

```
protocol ScreenFactory {
    associatedtype Route
    func make(route: Route) -> ScreenModule
}
```

---

# 3.5. Utils ‚Äî —É—Ç–∏–ª–∏—Ç—ã

–ü–∞–ø–∫–∞:

```
Sources/HybridFlowKit/Utils/
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã:

### **1. Logger.swift**

* –≤–∫–ª—é—á–∞–µ–º—ã–π/–≤—ã–∫–ª—é—á–∞–µ–º—ã–π –ª–æ–≥
* –≤—ã–≤–æ–¥–∏—Ç –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É Flow
* –≤—ã–≤–æ–¥–∏—Ç push/pop/present

### **2. Extensions**

* `UIViewController+Child.swift`: —É–¥–æ–±–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è child VC
* `UINavigationController+Convenience.swift`

---

# 4. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ Package.swift

Codex –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å –≤–∞–ª–∏–¥–Ω—ã–π –ø–∞–∫–µ—Ç:

* –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è:

  * iOS 15+
* –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Swift Concurrency
* –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

  * UIKit
  * SwiftUI

–ü—Ä–∏–º–µ—Ä–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```swift
// swift-tools-version:5.9
import PackageDescription

let package = Package(
    name: "HybridFlowKit",
    platforms: [
        .iOS(.v15)
    ],
    products: [
        .library(name: "HybridFlowKit", targets: ["HybridFlowKit"])
    ],
    targets: [
        .target(
            name: "HybridFlowKit",
            dependencies: [],
            path: "Sources/HybridFlowKit",
            resources: []
        )
    ]
)
```

Codex –¥–æ–ª–∂–µ–Ω –≤—Å—Ç–∞–≤–∏—Ç—å –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å.

---

# 5. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É

* –ß–∏—Å—Ç—ã–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, –±–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø—Ä–æ–µ–∫—Ç—É.
* UIKit –∏ SwiftUI –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ.
* –ú–µ—Ç–æ–¥—ã –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º.
* –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–æ–ª–∂–µ–Ω —Å–æ–±–∏—Ä–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫.
* –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ —Å—Ç—Ä–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –¢–ó.
* –ö–æ–¥ –ø–∏—Å–∞—Ç—å –≤ —Å—Ç–∏–ª–µ Apple (swiftlint-friendly).

---

# 6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞

Codex –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–∏—Ç—å:

1. **README.md** —Å:

   * –æ–ø–∏—Å–∞–Ω–∏–µ–º –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞,
   * —Å—Ö–µ–º–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π,
   * –ø—Ä–∏–º–µ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Flow,
   * –ø—Ä–∏–º–µ—Ä–æ–º —Å–æ–∑–¥–∞–Ω–∏—è Navigator –≤ —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

2. –î–æ–∫-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∫ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ—Ç–æ–∫–æ–ª—É.

---

# 7. –ß—Ç–æ –ù–ï –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å

* –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã (Home, Chat‚Ä¶).
* –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Combine, Alamofire –∏ —Ç.–ø.).
* –ù–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞—Ç—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É API.
* –ù–µ –¥–æ–±–∞–≤–ª—è—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

---

# 8. –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å

Codex –¥–æ–ª–∂–µ–Ω –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞—Ç—å:

* —Ñ–∞–π–ª–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É,
* –∫–∞—Ä–∫–∞—Å –∫–ª–∞—Å—Å–æ–≤,
* –ø—Ä–æ—Ç–æ–∫–æ–ª—ã,
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã,
* –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é,
* Package.swift,
* —á–∏—Å—Ç—ã–µ –ø—É—Å—Ç—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏,

—á—Ç–æ–±—ã –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ —ç—Ç–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –Ω–∞—á–∞—Ç—å —Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ç–æ–∫–∏ OnboardingFlow, AuthorizedFlow –∏ –ª—é–±—ã–µ –¥—Ä—É–≥–∏–µ.


